max.overlaps = Inf,
min.segment.length = 0,
lineheight = 0.85
) +
scale_fill_gradient(
low = "#EFF3FF",
high = "#08519C",
name = "百分比 (%)",
na.value = "grey95"
) +
labs(
title = paste0("樣本台灣分布 (N=", sum(sample_dist$樣本數), ")"),
subtitle = "依出生縣市統計"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
legend.position = "right"
)
print(p_map)
# 完整出生地統計表
birth_summary = data %>%
count(出生地_大分類, name = "樣本數") %>%
mutate(百分比 = 樣本數 / sum(樣本數) * 100) %>%
arrange(desc(樣本數))
cat("\n=== 完整出生地統計 ===\n")
print(birth_summary)
# 2. 台灣地區詳細統計
taiwan_detail = data %>%
filter(出生地_大分類 %in% c("台灣本島", "台灣離島")) %>%
count(出生地區, name = "樣本數") %>%
mutate(百分比 = 樣本數 / sum(樣本數) * 100) %>%
arrange(desc(樣本數))
cat("\n=== 台灣地區詳細統計 ===\n")
print(taiwan_detail)
# 3. 境外樣本詳細資訊
if(sum(data$出生地_大分類 == "其他國家", na.rm = TRUE) > 0) {
other_countries_detail = data %>%
filter(出生地_大分類 == "其他國家") %>%
count(出生縣市_其他說明, name = "樣本數") %>%
arrange(desc(樣本數))
cat("\n=== 其他國家詳細資訊 ===\n")
print(other_countries_detail)
}
# 建立四象限示意圖
quadrant_data = data.frame(
x = c(1, 1, 3, 3),
y = c(1, 3, 1, 3),
類型 = c("未參與", "被動攻擊", "主動問責", "主動攻擊"),
描述 = c(
"沒有行為\n旁觀者",
"取消關注/拒看\n靜默抵制",
"公開指責\n理性批評",
"言語攻擊\n情緒宣洩"
)
)
p_quadrant = ggplot(quadrant_data, aes(x = x, y = y)) +
geom_point(aes(color = 類型), size = 20, alpha = 0.6) +
geom_text(aes(label = 類型), size = 5, fontface = "bold") +
geom_text(aes(label = 描述), vjust = 3, size = 3.5, lineheight = 0.9) +
geom_hline(yintercept = 2, linetype = "dashed", color = "gray50") +
geom_vline(xintercept = 2, linetype = "dashed", color = "gray50") +
scale_color_manual(
values = c(
"未參與" = "gray70",
"被動攻擊" = "#FFA500",
"主動問責" = "#00BA38",
"主動攻擊" = "#F8766D"
)
) +
scale_x_continuous(
limits = c(0.5, 3.5),
breaks = c(1, 3),
labels = c("被動/無", "主動")
) +
scale_y_continuous(
limits = c(0.5, 3.5),
breaks = c(1, 3),
labels = c("低攻擊", "高攻擊")
) +
labs(
title = "網路正義行為四象限模型",
x = "參與程度",
y = "攻擊性程度"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "none",
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
panel.grid.minor = element_blank()
)
print(p_quadrant)
# Q16/Q17: 無害惡搞
cat("【Q16-Q17 無害惡搞】\n")
cat("參與無害惡搞：\n")
print(table(data$無害惡搞))
print(prop.table(table(data$無害惡搞)) * 100)
# Q18/Q19: 有害惡搞
cat("\n【Q18-Q19 有害惡搞】\n")
cat("參與有害惡搞：\n")
print(table(data$有害惡搞))
print(prop.table(table(data$有害惡搞)) * 100)
# 極端行為
cat("\n【極端行為（Q19_01 或 Q19_02）】\n")
print(table(data$極端行為))
print(prop.table(table(data$極端行為)) * 100)
# 交叉分析：行為類型 × 有害惡搞
cat("\n\n【行為類型 × 有害惡搞 交叉表】\n")
cross_tab = table(data$行為類型, data$有害惡搞)
print(cross_tab)
cat("\n比例（列百分比）：\n")
print(round(prop.table(cross_tab, margin = 1) * 100, 2))
# 卡方檢定
chi_test = chisq.test(cross_tab)
cat("\n卡方檢定：χ² =", round(chi_test$statistic, 3),
", df =", chi_test$parameter,
", p =", format.pval(chi_test$p.value), "\n")
# 視覺化
#圖一分組長條圖
# 計算百分比
q19_summary = data %>%
group_by(行為類型, 有害惡搞) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(行為類型) %>%
mutate(
total = sum(n),
pct = n / total * 100,
label = paste0(n, "\n(", round(pct, 1), "%)")
)
# 分組長條圖
p_q19_v1 = ggplot(q19_summary, aes(x = 行為類型, y = pct, fill = 有害惡搞)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7) +
geom_text(aes(label = label),
position = position_dodge(width = 0.8),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("無" = "skyblue", "有" = "pink")) +
labs(
title = "不同行為類型參與有害惡搞的比例",
x = "行為類型",
y = "百分比 (%)",
fill = "有害惡搞"
) +
theme_minimal(base_size = 12) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 11, face = "bold"),
legend.position = "top"
)
print(p_q19_v1)
#圖五熱力圖
# 交叉表轉為熱力圖
q19_heatmap = data %>%
group_by(行為類型, 有害惡搞) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(行為類型) %>%
mutate(pct = n / sum(n) * 100)
p_q19_v5 = ggplot(q19_heatmap, aes(x = 有害惡搞, y = 行為類型, fill = pct)) +
geom_tile(color = "white", linewidth = 1) +
geom_text(aes(label = paste0(n, "\n(", round(pct, 1), "%)")),
color = "black", size = 5, fontface = "bold") +
scale_fill_gradient(low = "white", high = "#E31A1C", name = "比例 (%)") +
labs(
title = "行為類型 × 有害惡搞 交叉分析",
x = "有害惡搞",
y = "行為類型"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.text = element_text(size = 11, face = "bold")
)
print(p_q19_v5)
library(tidyverse)
library(patchwork)
library(viridis)
library(scales)
cat("開始生成5大核心熱力圖\n")
# ===== 熱力圖1：正義升級路徑 =====
cat("【1/5】正義升級路徑熱力圖...\n")
upgrade_data <- data %>%
mutate(
被動曝露等級 = case_when(
被動攻擊曝露 < 2 ~ "低曝露",
被動攻擊曝露 < 3 ~ "中曝露",
TRUE ~ "高曝露"
),
被動曝露等級 = factor(被動曝露等級, levels = c("低曝露", "中曝露", "高曝露")),
主動攻擊等級 = case_when(
主動攻擊分數 < 1.5 ~ "低攻擊",
主動攻擊分數 < 2.5 ~ "中攻擊",
TRUE ~ "高攻擊"
),
主動攻擊等級 = factor(主動攻擊等級, levels = c("低攻擊", "中攻擊", "高攻擊")),
行為類型 = factor(行為類型, levels = c("未參與", "被動攻擊", "主動問責", "主動攻擊", "混合/其他"))
) %>%
count(被動曝露等級, 主動攻擊等級, 行為類型) %>%
group_by(被動曝露等級, 主動攻擊等級) %>%
mutate(pct = n / sum(n) * 100) %>%
ungroup()
p1_upgrade <- ggplot(upgrade_data,
aes(x = 主動攻擊等級, y = 行為類型, fill = pct)) +
geom_tile(color = "white", linewidth = 1.5) +
geom_text(aes(label = paste0(n, "\n", round(pct, 1), "%")),
color = "black", size = 3.5, fontface = "bold", lineheight = 0.9) +
facet_wrap(~被動曝露等級, ncol = 3) +
scale_fill_gradient(
low = "white",
high = "#E31A1C",
name = "比例 (%)",
limits = c(0, max(upgrade_data$pct, na.rm = TRUE))
) +
labs(
title = "正義行為升級路徑：被動曝露 → 主動攻擊 → 行為類型",
subtitle = "觀察不同曝露程度下，主動攻擊如何驅動行為升級",
x = "主動攻擊等級",
y = "行為類型"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, size = 10),
strip.text = element_text(size = 11, face = "bold", color = "white"),
strip.background = element_rect(fill = "#2C3E50", color = NA),
axis.text.x = element_text(angle = 45, hjust = 1, size = 9),
axis.text.y = element_text(size = 9),
legend.position = "right",
panel.border = element_rect(color = "gray80", fill = NA),
plot.margin = margin(10, 10, 10, 10)
)
print(p1_upgrade)
# ===== 熱力圖2：道德正當化機制 =====
cat("【2/5】道德正當化機制熱力圖...\n")
# 計算道德正當化指數
data = data %>%
mutate(
道德正當化指數 = (q20_01_1 + q20_02_1 + q25_01_1 + q25_02_1 + q25_03_1 + q25_04_1) / 6,
道德正當化程度 = case_when(
道德正當化指數 < 2 ~ "低正當化",
道德正當化指數 < 3 ~ "中正當化",
TRUE ~ "高正當化"
),
道德正當化程度 = factor(道德正當化程度,
levels = c("低正當化", "中正當化", "高正當化"))
)
moral_data = data %>%
count(道德正當化程度, 行為類型) %>%
group_by(道德正當化程度) %>%
mutate(pct = n / sum(n) * 100) %>%
ungroup()
p2_moral = ggplot(moral_data,
aes(x = 道德正當化程度, y = 行為類型, fill = pct)) +
geom_tile(color = "white", linewidth = 2) +
geom_text(aes(label = paste0(round(pct, 1), "%\n(n=", n, ")")),
color = "black", size = 5, fontface = "bold", lineheight = 0.9) +
scale_fill_gradient2(
low = "#2166AC",
mid = "white",
high = "#B2182B",
midpoint = 20,
name = "比例 (%)"
) +
labs(
title = "道德正當化 × 行為類型",
subtitle = "正當化程度越高，越傾向極端攻擊行為",
x = "道德正當化程度",
y = "行為類型"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, color = "#8B0000", size = 11),
axis.text.x = element_text(size = 11, face = "bold"),
axis.text.y = element_text(size = 11, face = "bold"),
legend.position = "right",
panel.grid = element_blank(),
plot.margin = margin(10, 10, 10, 10)
)
print(p2_moral)
# ===== 熱力圖3：情緒驅動機制 =====
cat("【3/5】情緒驅動機制熱力圖...\n")
emotion_data = data %>%
mutate(
生活滿意度_等級 = case_when(
生活滿意度 <= 2 ~ "不滿意",
生活滿意度 == 3 ~ "普通",
TRUE ~ "滿意"
),
生活滿意度_等級 = factor(生活滿意度_等級,
levels = c("不滿意", "普通", "滿意")),
快樂程度_等級 = case_when(
快樂程度 <= 2 ~ "不快樂",
快樂程度 == 3 ~ "普通",
TRUE ~ "快樂"
),
快樂程度_等級 = factor(快樂程度_等級,
levels = c("不快樂", "普通", "快樂")),
主動攻擊_等級 = case_when(
主動攻擊分數 < 1.5 ~ "低攻擊",
主動攻擊分數 < 2.5 ~ "中攻擊",
TRUE ~ "高攻擊"
),
主動攻擊_等級 = factor(主動攻擊_等級,
levels = c("低攻擊", "中攻擊", "高攻擊"))
) %>%
count(生活滿意度_等級, 快樂程度_等級, 主動攻擊_等級) %>%
group_by(生活滿意度_等級, 快樂程度_等級) %>%
mutate(pct = n / sum(n) * 100) %>%
ungroup()
p3_emotion = ggplot(emotion_data,
aes(x = 快樂程度_等級, y = 生活滿意度_等級, fill = pct)) +
geom_tile(color = "white", linewidth = 1.5) +
geom_text(aes(label = paste0(round(pct, 1), "%")),
color = "white", size = 4.5, fontface = "bold") +
facet_wrap(~主動攻擊_等級, ncol = 3) +
scale_fill_gradient(
low = "#FFF5F0",
high = "#8B0000",
name = "比例 (%)"
) +
labs(
title = "情緒狀態 × 主動攻擊行為",
subtitle = "生活不滿意 + 不快樂 → 高攻擊傾向",
x = "快樂程度",
y = "生活滿意度"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, color = "#8B0000", size = 10),
strip.text = element_text(size = 11, face = "bold", color = "white"),
strip.background = element_rect(fill = "#8B0000", color = NA),
axis.text = element_text(size = 10, face = "bold"),
legend.position = "right",
panel.border = element_rect(color = "gray80", fill = NA),
plot.margin = margin(10, 10, 10, 10)
)
print(p3_emotion)
# ===== 熱力圖4：同理心保護因子 =====
cat("【4/5】同理心保護因子熱力圖...\n")
empathy_data = data %>%
mutate(
同理心等級 = case_when(
q31_1 <= 2 ~ "低同理心",
q31_1 == 3 ~ "中同理心",
q31_1 == 4 ~ "高同理心",
TRUE ~ NA_character_
),
同理心等級 = factor(同理心等級,
levels = c("低同理心", "中同理心", "高同理心")),
極端行為 = if_else(q18 == 1 & (q19_01 == 1 | q19_02 == 1), "有極端行為", "無極端行為"),
極端行為 = factor(極端行為, levels = c("無極端行為", "有極端行為"))
) %>%
filter(!is.na(同理心等級)) %>%
count(同理心等級, 極端行為, 行為類型) %>%
group_by(同理心等級, 極端行為) %>%
mutate(pct = n / sum(n) * 100) %>%
ungroup()
p4_empathy = ggplot(empathy_data,
aes(x = 極端行為, y = 行為類型, fill = pct)) +
geom_tile(color = "white", linewidth = 1.5) +
geom_text(aes(label = paste0(round(pct, 1), "%\n(n=", n, ")")),
color = "black", size = 3.5, fontface = "bold", lineheight = 0.9) +
facet_wrap(~同理心等級, ncol = 3) +
scale_fill_gradient(
low = "blue",
high = "red",
name = "比例 (%)"
) +
labs(
title = "同理心 × 極端行為 × 行為類型",
subtitle = "高同理心作為保護因子：降低極端行為參與",
x = "是否參與極端行為",
y = "行為類型"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, color = "blue", size = 10),
strip.text = element_text(size = 11, face = "bold", color = "white"),
strip.background = element_rect(fill = "blue", color = NA),
axis.text.x = element_text(angle = 45, hjust = 1, size = 9),
axis.text.y = element_text(size = 9),
legend.position = "right",
panel.border = element_rect(color = "gray80", fill = NA),
plot.margin = margin(10, 10, 10, 10)
)
print(p4_empathy)
# ===== 熱力圖5：核心變項相關矩陣 =====
cat("【5/5】核心變項相關矩陣熱力圖...\n")
# 準備相關矩陣資料
cor_data <- data %>%
dplyr::select(
被動攻擊曝露,
主動攻擊分數,
道德正當化指數,
生活滿意度,
快樂程度,
年齡
) %>%
na.omit()
# 計算相關矩陣
cor_matrix <- cor(cor_data, use = "complete.obs")
# 計算 p 值
library(Hmisc)
cor_result <- rcorr(as.matrix(cor_data), type = "pearson")
r_matrix <- cor_result$r
p_matrix <- cor_result$P
# 轉為長格式
cor_long <- as.data.frame(cor_matrix) %>%
rownames_to_column("b1") %>%
pivot_longer(-b1, names_to = "b2", values_to = "r") %>%
mutate(
p_value = as.vector(p_matrix),
significance = case_when(
is.na(p_value) ~ "",
p_value < 0.001 ~ "***",
p_value < 0.01 ~ "**",
p_value < 0.05 ~ "*",
TRUE ~ ""
),
labels = if_else(b1 == b2,
"1.00",
paste0(round(r, 2), significance))
# 標註 Likert 變項
b1_type = if_else(b1 %in% c("生活滿意度", "快樂程度"),
b1_type = if_else(b1 %in% c("生活滿意度", "快樂程度"),
paste0(b1, "\n(Likert)"), b1)
# 轉為長格式
cor_long <- as.data.frame(cor_matrix) %>%
rownames_to_column("b1") %>%
pivot_longer(-b1, names_to = "b2", values_to = "r") %>%
mutate(
p_value = as.vector(p_matrix),
significance = case_when(
is.na(p_value) ~ "",
p_value < 0.001 ~ "***",
p_value < 0.01 ~ "**",
p_value < 0.05 ~ "*",
TRUE ~ ""
),
labels = if_else(b1 == b2,
"1.00",
paste0(round(r, 2), significance))
# 標註 Likert 變項
b1_type = if_else(b1 %in% c("生活滿意度", "快樂程度"),
# 轉為長格式
cor_long <- as.data.frame(cor_matrix) %>%
rownames_to_column("b1") %>%
pivot_longer(-b1, names_to = "b2", values_to = "r") %>%
mutate(
p_value = as.vector(p_matrix),
significance = case_when(
is.na(p_value) ~ "",
p_value < 0.001 ~ "***",
p_value < 0.01 ~ "**",
p_value < 0.05 ~ "*",
TRUE ~ ""
),
labels = if_else(b1 == b2,
"1.00",
paste0(round(r, 2), significance)),
b1_type = if_else(b1 %in% c("生活滿意度", "快樂程度"),
paste0(b1, "\n(Likert)"), b1),
b2_type = if_else(b2 %in% c("生活滿意度", "快樂程度"),
paste0(b2, "\n(Likert)"), b2)
)
p5_correlation = ggplot(cor_long, aes(x = b2_type, y = b1_type, fill = r)) +
geom_tile(color = "white", linewidth = 1.2) +
geom_text(aes(label = labels),
color = "black", size = 4, fontface = "bold") +
scale_fill_gradient2(
low = "#2166AC",
mid = "white",
high = "#B2182B",
midpoint = 0,
limits = c(-1, 1),
name = "Pearson R"
) +
labs(
title = "核心變項相關矩陣",
subtitle = "*** p<.001, ** p<.01, * p<.05| Likert 量表視為近似連續變項",
x = NULL,
y = NULL
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = "bold"),
axis.text.y = element_text(size = 10, face = "bold"),
legend.position = "right",
panel.grid = element_blank(),
plot.margin = margin(10, 10, 10, 10)
)
print(p5_correlation)
# 準備相關矩陣資料
cor_data <- data %>%
dplyr::select(
被動攻擊曝露,
主動攻擊分數,
道德正當化指數,
生活滿意度,
as.numeric(快樂程度),
年齡
) %>%
na.omit()
# 計算相關矩陣
cor_matrix <- cor(cor_data, use = "complete.obs")
